local listOfImages={
 "1832410963637373669/0B2F27A66FDE7A24F59385C3B6907DC9FFF150AF/",
 "1832410963637373499/3FC7D688BE492981614454D3673B30B95C5BA88A/",
 "1832410963637373097/B9FAE997CC9128631702356374A3806D6B5F9DD7/",
 "1832410963637372969/35C706E956284140BB8BA3A830703A8D0F24786B/",
 "1832410963637372819/80FCED5BC4FA41D5AB92171D55F9A400DEC17C10/",
 "1832410963637372634/2B7B3441D9274102086A5A93230BD429E7A22012/",
 "1832410963637372412/C5E490485B2AA2E8427394744D5D370DD08440F8/",
 "1832410963637372208/EBB973EA63CE407AD358702AEADD883C6B8987AF/",
 "1832410963637371996/AF122B586BE6E2ABD4F859352F9E9EB233373144/",
 "1832410963637371778/4AF9148E963A16FC80B64ABE96CD32D71379CA4B/",
 "1832410963637371411/9877156C3AFC01D6644D1A14C38C1A3F261A4394/",
 "1832410963637370905/E145608EF8A6ADB8648B94F9473740BDDB5A4102/",
 "1832410963637370527/EE14E693352DC6D66400B66DFC312187A5238D6B/",
 "1832410963637370392/EA1D7ECE64FCCD1E7CA29C10E65631B2233CB5C6/",
 "1832410963637370181/ABDDD0072B7780AC49030ADF9D7A9975A11DDC9D/",
 "1832410963637370064/D79137AAEF75FB19500C35FB34D318E617D86EFA/",
 "1832410963637369946/664640343EA7073CCFDCD70EA675B67DDEB51723/",
 "1832410963637369830/663643B5D4F7DFEEF8C8683B63C719026CC81A78/",
 "1832410963637369683/25A3CFC4E0FBF212B0D966AFD581ED81B011EEA9/",
 "1832410963637369485/8BB95E04707DBA3398D938811A534DC9CD7DA810/",
 "1832410963637369061/FA68133FFFA397DBD15A75E13FBEEDDBE4FB8D88/",
 "1832410963637368938/9D32B63FDCCCB7C92EB5214E18DB6BD2DF567766/",
 "1832410963637368822/103F1032663F585B785F6E0645F190CE8C7C7710/",
 "1832410963637368665/7BB68794A8DBEA27DFE5D635F09797ADBFB9EE42/",
 "1832410963637368479/569FA0EF90C3B36500ECAE5F2A9FD083271B6101/",
 "1832410963637368321/2390A07D61355EFB14B733D11AB06A7D69BDC94F/",
 "1832410963637368135/81D0ED9FE44F74F567AD9DB925E3C35CABECC81A/",
 "1832410963637367953/0555B7920871609A60F8059251EA744D4A336DEA/",
 "1832410963637367701/8F7BB0F4BB8CF5DE169D880FA8AFC6DFE6F03272/",
 "1832410963637367471/6C58E8941B1330253DE81759D697F3679CD668DD/",
 "1832410963637367290/8431D50F5FA578485B567607341240D94A4CDD62/",
 "1832410963637366886/6426374A7BEAE4D702AA6DB59F1197B1E97B413C/",
 "1832410963637367071/BA2AFC850479B3B44D8AEE02DD068E3EE87B600A/",
 "1832410963637366778/6B81016286912206A7BFAA182F9037174C86B3C2/",
 "1832410963637366587/B5062723706AB0CD23A7B426F9EB4568886D942E/",
 "1832410963637366380/6912651D056B2B94151F848D853251ED96EE7E82/",
 "1832410963637366064/75D914A03AB47DD3E9B54B7F0A7E49C0A255FE6A/",
 "1832410963637365896/D41D1423E72C543D991B5E58CCE129FA3AEFB2BF/",
 "1832410963637365723/99E82175633FCE5FCF8FA5C7482AEE7D973C8CFD/",
 "1832410963637365331/C5B3315FBA9A8A68A0C983668967C496DCCC7EC2/",
 "1832410963637365133/8CB4BF35A09D57E8BCEF4B12E92F9E7CA14E12FF/",
 "1832410963637364932/18EEBB1261A88B3AF2219B8F315142D68A83E842/",
 "1832410963637364764/535A9F9847B9C8706B598DC106397E6E3CB6101C/",
 "1832410963637364598/20388E672632F04A2F4F76D7A5D0BCE5777B6485/",
 "1832410963637364353/BA7A57C7735F69F4739EC0332E35162B75480C7C/",
 "1832410963637364142/7B47D3DD34E75518E2D22CBBFE34041751941FAB/",
 "1832410963637363996/A9F4F2E1C51C4437EE553BDEA8D1E497C87C5D71/",
 "1832410963637363824/B8FA2BEE47C89C0FD5295DD3A467629ADCC2D8A4/",
 "1832410963637363663/4B173E99BA296231FA665B50E1DB0383AB0E195C/",
 "1832410963637363513/F412C35316AB9D62C36D9B6CF59FF4AF4035D7F9/",
 "1832410963637363320/EBB3C1ECDAA4A4C5FCD86A84DDB3CE2FE1272EE4/",
 "1832410963637363137/1AE32616ADD9ED8D95522FF221FB695858FF817B/",
 "1832410963637362972/C0E817616907E9D3180E9D4AB321406F3A3DABB7/",
 "1832410963637362813/8837487DF034EBFF4555C62CE6B1732FBD8216F6/",
 "1832410963637361935/441899E0701F1165A199208EE28B1E22CF79BA70/",
 "1832410963637361416/D7B7912E6263FB4CF912E7BADF4B1A319BAB52AD/",
 "1832410963637362627/999187CDEA15BF6A4D2CF4280368D963F62B7E08/",
 "1832410963637361220/25B52F6C457AE588109F9BA29EE3B1EC1B6FB4A7/",
 "1832410963637361055/49F9C3BD65B87CE712CFE19B0FEAB86AC407A5DA/",
 "1832410963637360858/4170882C58572869CA686A6C9072B6C338E0C4CC/",
 "1832410963637360621/70A7F5D796AD6CC09C0676BEE2AC697811A96462/",
 "1832410963637360431/8003BAF3C7B531D9378A0B01A8B8F9376E29B51C/",
 "1832410963637360160/D78F622058E07575E512FBA264523DEEDE03EBA9/",
 "1832410963637359780/522020541B585FDD69E8B3CB6507D3E16312B1E0/",
 "1832410963637359601/7F9D94EC50BB60B401D75ECE4614E3BE62C20B2D/",
 "1832410963637359131/58DF244D3CA11F00BAFEB1EED56799F355AD93B6/",
 "1832410963637358932/077108AB2384E28E99E51E1564685BE8975BBA38/",
 "1832410963637358685/768F2DD4E3FD42909B3174EFDC7AA8BA12077741/",
 "1832410963637358503/9DB4646C14A491F9E664A488AE0BDB8B222C6E1B/",
 "1832410963637358200/E7CF598404376A077D7DC3F9F4F568132C2A2FE3/",
 "1832410963637358033/DD28C7E98DD255FA7C8617077D1EE4AD7AE2CCCD/",
 "1832410963637357872/D99879886B1A28A14851A05DB8EF971EB0F27F3A/",
 "1832410963637357741/23A2F240316E45AC90871ADEF2F899222A82892B/",
 "1832410963637357559/43610969F9E99810D0FB8DCF9C9608E2972AC2D0/",
 "1832410963637357355/27E41FF414C3EE13291DC31CB7B5B5DEBD78B32C/",
 "1832410963637357134/240F9C518670D39422E78B64FA663ECE60A36756/",
 "1832410963637356873/21C4F2CF5DB0ADFF8C4FC47EA811C50C08D470E5/",
 "1832410963637356662/E9C5D5E75AE227056C9B62754CAEAC7EDCC706BB/",
 "1832410963637356469/5DD6CAD1674882ACC5DE12BEBF0C991404ABC1B7/",
 "1832410963637356320/007FF608D4C25145487591CBD87E8A3F0C218E57/",
 "1832410963637356084/FAC92C0E63532A8EC9867B724546E3EC03CB1D40/",
 "1832410963637355947/CB8EED7E8705109CDF2241F0433D7F2B44E31D81/",
 "1832410963637355776/D76065C40731F3D04DAA63484C778A728F885F71/",
 "1832410963637355620/9D7FF70CA91E590671DB8AEB232D3A4F46E67A62/",
 "1832410963637355428/62DC5882D814F84EB66699D554C3644737DD210F/",
 "1832410963637355066/02CDD7E71483466C3817E0F1AA22636B5B83C4BB/",
 "1832410963637354966/25EA470516222E80020379E0C72F1BA2AA29F9FC/",
 "1832410963637375275/10BA2533EF12BD905DE95D371F1B4901C8C9E175/",
 "1832410963637354772/3EEB3F044EF9E40F5BDAA69DE99CEB331A4BB7FC/",
 "1832410963637354667/5F5BCFAD8A5103B3D51942F3B226ED85A73476A9/",
 "1832410963637354544/F7C2EAD65F70DA92BDFF70181288572C52837164/",
 "1832410963637375465/9CC4C2BF2793AF72101210712D503DA7DF4A9C7A/",
 "1832410963637375658/344CF7E8640F8BB02CB2F3473927D5A4F2FDDF65/",
 "1832410963637375875/BE5AB5E79A02A9C923EFA89C0A38E867931094CD/",
 "1832410963637376342/3501225F4B6A675F4D70589BF55C137AC7323BFA/",
 "1832410963637376522/B69E91DDD37ECBC6FB79F4EFC1D87F5E9B93A9C8/",
 "1832410963637376708/3EA7C7D33E49FAC5C607E888B3CB756B67DE9E72/",
 "1832410963637376905/D320B8BB7ACB28412AD59417272419BEDEBD4BA2/",
 "1832410963637373851/E19EA4587163ABD02ABED8CDAF945B0637A122C8/",
 "1832410963637373999/752ED8BE5B744C5350FDFE8A745949BBC644B50F/",
 "1832410963637374145/59DA99B2271D96EAA79D85D9E0CFA3AECD28C6D2/",
 "1832410963637374300/1E324B980B701B3413E2CA62980BECC5F808AFBB/",
 "1832410963637374476/C7D8200EB2B232B3E80C1ECA5CD33531A31C2CA4/",
 "1832410963637374644/7D2297FF65A2B7D62A762CEBCB46B1030E66013F/",
 "1832410963637374813/3C65934A0588ECA168522E34EBF36AD6B74F677B/",
 "1832410963637375038/DB265CF5C6EC0C231D023252CE0AF0FFCF7F1BE6/"
}

lastButtonPress=os.time()
snaps5={
 {position={0.9,0.1,0.7}},--bench 1 card
 {position={0.44,0.1,0.7}},--bench 2 card
 {position={-0.02,0.1,0.7}},--bench 3 card
 {position={-0.48,0.1,0.7}},--bench 4 card
 {position={-0.94,0.1,0.7}},--bench 5 card
 {position={0.9,0.1,0.575}},--bench 1 BREAK
 {position={0.44,0.1,0.575}},--bench 2 BREAK
 {position={-0.02,0.1,0.575}},--bench 3 BREAK
 {position={-0.48,0.1,0.575}},--bench 4 BREAK
 {position={-0.94,0.1,0.575}},--bench 5 BREAK
 {position={0.71,0.1,0.9525},rotation_snap=true},--bench 1 energy
 {position={0.25,0.1,0.9525},rotation_snap=true},--bench 2 energy
 {position={-0.21,0.1,0.9525},rotation_snap=true},--bench 3 energy
 {position={-0.67,0.1,0.9525},rotation_snap=true},--bench 4 energy
 {position={-1.13,0.1,0.9525},rotation_snap=true},--bench 5 energy
 {position={-0.0025,0.1,-0.715}},--active card
 {position={-0.0025,0.1,-0.84}},--active BREAK
 {position={-0.1925,0.1,-0.4625},rotation_snap=true},--active energy
 {position={1.537,0.1,-0.401}},--prize 1
 {position={1.263,0.1,-0.401}},--prize 2
 {position={1.537,0.1,0.03}},--prize 3
 {position={1.263,0.1,0.03}},--prize 4
 {position={1.537,0.1,0.461}},--prize 5
 {position={1.263,0.1,0.461}},--prize 6
 {position={-1.41,0.1,0.03},rotation_snap=true},--deck
 {position={-1.41,0.1,0.463},rotation_snap=true},--discard
 {position={-1.41,0.1,-0.38}},--GX Coin
 {position={-1.36,0.1,-0.76}},--Stadium
}
snaps8={
 {position={0.44,0.1,0.05}},--bench 6 card
 {position={-0.02,0.1,0.05}},--bench 7 card
 {position={-0.48,0.1,0.05}},--bench 8 card
 {position={0.44,0.1,-0.075}},--bench 6 BREAK
 {position={-0.02,0.1,-0.075}},--bench 7 BREAK
 {position={-0.48,0.1,-0.075}},--bench 8 BREAK
 {position={0.25,0.1,0.3025},rotation_snap=true},--bench 6 energy
 {position={-0.21,0.1,0.3025},rotation_snap=true},--bench 7 energy
 {position={-0.67,0.1,0.3025},rotation_snap=true},--bench 8 energy
}

function onLoad(state)
 if state!="" then
  local save=json.parse(state)
  curImage=tonumber(save.curImage)
  curCut=save.curCut
  bench8=save.bench8
 else
  curImage=1
  curCut=7
  bench8=false
 end
 if self.GetCustomObject().image!=getSteamUrl(listOfImages[curImage])then changeArt()end
 setUpBoard()

 local selfScale=self.getScale()
 local params={function_owner=self,
  input_function="updateArtToText",
  position={-1.63,0.1,-0.97},
  scale={1/selfScale.x,1/selfScale.y,1/selfScale.z},
  width=400,
  height=223,
  font_size=200,
  color={0,0,0.5},
  font_color={1,1,1},
  tooltip="Set Board Art",
  alignment=3,
  value=tostring(curImage),
 }
 self.createInput(params)

 params.input_function="setCutAmount"
 params.tooltip="Amount to Cut"
 params.width=450
 params.position={1.63,0.1,0.05}
 params.value=tostring(curCut)
 self.createInput(params)

 wellData={Transform={posX=0,posY=0,posZ=0,rotX=0,rotY=0,rotZ=0,scaleX=0.01,scaleY=0.01,scaleZ=0.01},Name="Custom_Assetbundle_Bag",Nickname="Attach Well",Description="Place cards you attach to Pokemon here!",Locked=true,CustomAssetbundle={AssetbundleURL="http://chry.me/up/new_blackhole4.unity3d",AssetbundleSecondaryURL="",MaterialIndex=2,TypeIndex=6,LoopingEffectIndex=0},Bag={Order=0},LuaScript=WellLuaScript
}

 self.addContextMenuItem("Delete Wells",function(player_color)deleteWells()end)
 self.addContextMenuItem("Respawn Wells",function(player_color)createWells()end)
 createWells()
end

for c=1,5 do
 _G["clickSwitch"..tostring(c)]=function(_,color)switch(self.positionToWorld({-0.0225,1.11,-0.715}),self.positionToWorld({1.34-(c*0.46),1.11,0.7}),color)end
end
for c=6,8 do
 _G["clickSwitch"..tostring(c)]=function(_,color)switch(self.positionToWorld({-0.0225,1.11,-0.715}),self.positionToWorld({3.18-(c*0.46),1.11,0.05}),color)end
end

function setUpBoard()
 self.clearButtons()
 local snaps={}
 if bench8 then
  for c=1,#snaps5 do
   snaps[#snaps+1]=snaps5[c]
  end
  for c=1,#snaps8 do
   snaps[#snaps+1]=snaps8[c]
  end
 else
  snaps=snaps5
 end
 self.setSnapPoints(snaps)
 local selfScale=self.getScale()
 local params={function_owner=self,
 label='Switch',
 tooltip='Switch Bench with Battle Field',
 font_size=200,
 color={0,0,0.5},
 font_color={1,1,1},
 width=1250,
 height=250,
 scale={1/selfScale.x,1/selfScale.y,1/selfScale.z},
 position={0,0.1,0.4},
 rotation={0,0,0},
 }
 local offset=0.025
 local spaceBetween=0.46
 for c=1,5 do
  params.position[1]=(c-3)*spaceBetween+offset
  params.click_function='clickSwitch'..tostring(c)
  self.createButton(params)
 end
 if bench8 then
  params.position[3]=-0.25
  for c=6,8 do
   params.position[1]=(c-7)*spaceBetween+offset
   params.click_function='clickSwitch'..tostring(c)
   self.createButton(params)
  end
 end

 params.position={-1.4,0.1,0.7}
 params.click_function='set6Prizes'
 params.label='Setup 6 Prizes'
 params.tooltip='Take 6 prizes from your Deck'
 self.createButton(params)

 params.position[3]=0.8
 params.click_function='set4Prizes'
 params.label='Setup 4 Prizes'
 params.tooltip='Take 4 prizes from your Deck'
 self.createButton(params)

 params.position[1]=1.4
 params.click_function='toggleBench'
 if bench8 then
  params.label='Normal Bench'
  params.tooltip='Switch to a 5 mon bench'
 else
  params.label='Large Bench'
  params.tooltip='Switch to an 8 mon bench'
 end
 self.createButton(params)

 params.label='Cut\nTop\nX'
 params.tooltip='Cut the top X cards of the deck and places them aside, as Cutting the top of a face-Down deck is awkward in TTS otherwise. What you think cuts from the top actually cuts from the bottom.\nX is set by the number below.'
 params.position={1.63,0.1,-0.12}
 params.height=640
 params.width=450
 params.click_function="cutTopDeck"
 self.createButton(params)

 params.label='Cut\nBot.\nX'
 params.tooltip='Cut the bottom X cards of the deck and places them aside\nX is set by the number below.'
 params.position[3]=0.22
 params.click_function="cutBottomDeck"
 self.createButton(params)

 params.label='+'
 params.tooltip='Increase Cut Amount'
 params.height=250
 params.color={0,0.5,0}
 params.position[3]=0.01
 params.click_function="incCut"
 self.createButton(params)

 params.label='-'
 params.color={1,0,0}
 params.tooltip='Decrease Cut Amount'
 params.position[3]=0.09
 params.click_function="decCut"
 self.createButton(params)

 params.tooltip='Previous Board Art'
 params.width=200
 params.position={-1.69,0.1,-0.97}
 params.click_function="previousArt"
 self.createButton(params)

 params.label='+'
 params.color={0,0.5,0}
 params.tooltip='Next Board Art'
 params.position[1]=-1.57
 params.click_function="nextArt"
 self.createButton(params)
end

function previousArt(obj,color,alt_click)
 curImage=curImage-1
 if curImage==0 then curImage=#listOfImages end
 changeArt()
end

function nextArt(obj,color,alt_click)
 curImage=curImage+1
 if curImage>#listOfImages then curImage=1 end
 changeArt()
end

function updateArtToText(obj,color,value,selected)
 if not selected and value!=curImage then
  newValue=checkIfNum(value,#listOfImages,curImage,color)
  if newValue!=curImage then
   curImage=newValue
   changeArt()
  end
  return tostring(curImage)
 end
end

function setCutAmount(obj,color,value,selected)
 if not selected then
  curCut=checkIfNum(value,100,curCut,color)
  saveData()
  return tostring(curCut)
 end
end

function checkIfNum(value,max,current,color)
 local numValue=tonumber(value)
 if numValue!=nil then
  numValue=math.floor(numValue)
  if numValue>0 then
   if numValue<=max then return numValue else broadcastToColor("Enter a lower number.",color,{1,0,0})end
  else broadcastToColor("Enter a number above 0.",color,{1,0,0})end
 else broadcastToColor("Enter a number.",color,{1,0,0})end
 return current
end

function incCut()
 curCut=curCut+1
 self.editInput({index=1,value=tostring(curCut)})
 saveData()
end

function decCut(obj,color)
 if curCut>2 then
  curCut=curCut-1
  self.editInput({index=1,value=tostring(curCut)})
  saveData()
 else
  broadcastToColor("Already at minimum.",color,{1,0,0})
 end
end

function cutTopDeck(obj,color)
 deck=getDeck(color)
 if deck then
  decksize=deck.getQuantity()
  if decksize>=curCut+2 then
   decks=deck.cut(decksize-curCut)
   selfRot=self.GetRotation()
   selfRot.z=selfRot.z+180
   decks[2].setRotation(selfRot)
   decks[1].setPositionSmooth(self.positionToWorld({-2,1,0.03}),false,true)
  else
   broadcastToColor("Deck is too small.",color,{1,0,0})
  end
 end
end

function cutBottomDeck(obj,color)
 deck=getDeck(color)
 if deck then
  decksize=deck.getQuantity()
  if decksize>=curCut+2 then
   decks=deck.cut(curCut)
   selfRot=self.GetRotation()
   selfRot.z=selfRot.z+180
   decks[2].setRotation(selfRot)
   decks[2].setPositionSmooth(self.positionToWorld({-2,1,0.03}),false,true)
  else
   broadcastToColor("Deck is too small.",color,{1,0,0})
  end
 end
end

function getDeck(color)
 local zone=Physics.cast({origin=self.positionToWorld({-1.41,0.6,0.03}),direction={0,1,0},type=3,size={2.5,1,4},max_distance=0,orientation=self.GetRotation()})
 for _,collision in pairs(zone) do
  hit=collision.hit_object
  if hit.type=="Deck"then
   return hit
  end
 end
 broadcastToColor("Deck doesn't exist.",color,{1,0,0})
end

function changeArt()
 self.setCustomObject({image=getSteamUrl(listOfImages[curImage])})
 saveData()
 self.reload()
end

function getSteamUrl(url)
 return "http://cloud-3.steamusercontent.com/ugc/"..url
end

function saveData()
 local save={curImage=curImage,curCut=curCut,bench8=bench8}
 self.script_state=json.serialize(save)
end

function switch(pos1,pos2,color)
 if os.difftime(os.time(),lastButtonPress)<0.5 then broadcastToColor("You can't switch that fast.",color,{1,0,0})return end
 lastButtonPress=os.time()
 local zone1=Physics.cast({origin=pos1,direction={0,1,0},type=3,size={2.5,2,4},max_distance=0,orientation=self.GetRotation()})
 local zone2=Physics.cast({origin=pos2,direction={0,1,0},type=3,size={2.5,2,4},max_distance=0,orientation=self.GetRotation()})
 for _,collision in pairs(zone1) do
  moveObject(collision.hit_object,pos1,pos2)
 end
 for _,collision in pairs(zone2) do
  moveObject(collision.hit_object,pos2,pos1)
 end
 lastButtonPress=os.time()
end

function moveObject(object,srcOrigin,dstOrigin)
 objPos=object.getPosition()
 relativePos={x=objPos.x-srcOrigin.x,y=objPos.y-srcOrigin.y,z=objPos.z-srcOrigin.z}
 object.setPositionSmooth({x=dstOrigin.x+relativePos.x,y=dstOrigin.y+relativePos.y,z=dstOrigin.z+relativePos.z},false,true)
end

function checkForWell(pos)
 return Physics.cast({origin=pos,direction={0,1,0},type=3,size={0.5,0.5,0.5},max_distance=0,orientation=self.GetRotation()})
end

wellLocs={{-0.1925,0.12,-0.4625},{0.71,0.12,0.9525},{0.25,0.12,0.9525},{-0.21,0.12,0.9525},{-0.67,0.12,0.9525},{-1.13,0.12,0.9525}}
wellLocs8={{0.25,0.12,0.3025},{-0.21,0.12,0.3025},{-0.67,0.12,0.3025}}

function deleteWells()
 for c=1,#wellLocs do
  deleteWell(wellLocs[c])
 end
 for c=1,#wellLocs8 do
  deleteWell(wellLocs8[c])
 end
end

function deleteWell(pos)
 local zone=checkForWell(self.positionToWorld(pos))
 for _,collision in pairs(zone) do
  if collision.hit_object.getName()==wellData.Nickname and collision.hit_object.type=="Bag"then
   collision.hit_object.destruct()
  end
 end
end

function createWells()
 for c=1,#wellLocs do
  createWell(wellLocs[c])
 end
 if bench8 then
  for c=1,#wellLocs8 do
   createWell(wellLocs8[c])
  end
 end
end

function createWell(pos)
 local zone=checkForWell(self.positionToWorld(pos))
 local hit=false
 for _,collision in pairs(zone) do
  if collision.hit_object.getName()==wellData.Nickname and collision.hit_object.type=="Bag"then hit=true end
 end
 if not hit then
  local selfScale=self.getScale()
  spawnObjectData({data=wellData,position=self.positionToWorld(pos),rotation=self.GetRotation(),scale={0.0145278450363*selfScale[1],0.05,0.0145278450363*selfScale[3]}})
 end
end

function set6Prizes(obj,color,alt_click)
 setPrizes(color,6)
end

function set4Prizes(obj,color,alt_click)
 setPrizes(color,4)
end

function setPrizes(color,number)
 deck=getDeck(color)
 if deck then
  for c=0,number-1,1 do
   deck.takeObject({position=self.positionToWorld({1.263+(0.274*(c%2)),1,-0.401+(math.floor(c/2)*0.431)})})
  end
  return
 end
end

function toggleBench()
 if bench8 then
  bench8=false
  for c=1,#wellLocs8 do
   deleteWell(wellLocs8[c])
  end
 else
  bench8=true
  createWells()
 end
 setUpBoard()
 saveData()
end

WellLuaScript=[[--PTCG Energy Well,created by Lotus Assassin and edited by Pepper0ni
energyUI={
 ["Darkness Energy"]="1030706086614178330/4BF95A690F7DA49C8FB1463B8E5F678703F7F45C/",
 ["Fairy Energy"]="1030706086614178507/2BB4792D5BF0D974368EFDE432484ABBCDB33AA0/",
 ["Fighting Energy"]="1030706086614178613/6211E80FA57B3462D3A78C725AE440B01D85F19B/",
 ["Grass Energy"]="1030706086614178225/936511C7DE88071C0EFD164A0208E9A4F0790121/",
 ["Fire Energy"]="1030706086614178732/FB70D14FE2A4CA823E53CA4B950D58C999D57E4A/",
 ["Lightning Energy"]="1030706086614178847/5043B10E02EF709244486A5E2F037DFA5ABB5211/",
 ["Metal Energy"]="1030706086614178951/97976CC1484C2344BF88BC4EDFCB5E4A74594199/",
 ["Psychic Energy"]="1030706086614179070/5936733CF9AA0FEC120262A82643501F5D98BC01/",
 ["Water Energy"]="1030706086614179173/A6197B243E1F67E908D76B837FC3EDCCCDD399EC/",
 ["Double Colorless Energy"]="1820017796661631080/0DF9A2A289E0A0EB41728D6E215B1C87D01B182F/",
 ["Rainbow Energy"]="1683750229115782770/686ED8BFB2DC9AB55651674D0DEDC386BBF83784/",
 ["Full Heal Energy"]="1820018084943436739/F11F0E246B75AF4CC47D6A5B6AEC8D81FC1D1B24/",
 ["Potion Energy"]="1820018084943436105/8F803D1464FD0AB7589FAEAFB7A084FD26E26685/",
 ["Recycle Energy"]="1683750229115826732/66452D1F13201E093655BDD5703EDCDC3CF78B10/",
 ["Miracle Energy"]="1820018084943436418/776B312E63A52234CB59B4EB31B92D53390C4C60/",
 ["Boost Energy"]="1683750229116751942/799829CDDF5C8C3F9194A0ACE8BDE760DDD64E52/",
 ["Crystal Energy"]="1820017796661887284/5C9B8E0D6398A84B97303FED3F4E5FE2C37AC30F/",
 ["Warp Energy"]="1820018084943435313/D857842996C95F4625C98A32A071386155EBA85C/",
 ["Bounce Energy"]="1820018084943434875/8DA68E040714AEA804048F1C27B7E7B9B2430E54/",
 ["Cyclone Energy"]="1820018084943434445/4DFE8C43D7147091CD431C189E95EAE199AF1880/",
 ["Retro Energy"]="1820018084943433833/A6AA551493059C2512A083E6D2C4446F361308B5/",
 ["Multi Energy"]="1683750229116785523/0D8F3F0A4A3C5A852F4EE76C13287CB6E889D801/",
 ["Aqua Energy"]="1683750229116800888/6B359D728DB5A6C702B686690583F3B0EDF5A67C/",
 ["Magma Energy"]="1683750229116811962/F2E8224C083FD37C4A8A270521BD720D006EC070/",
 ["Double Rainbow Energy"]="1683750229116792942/8D79544B0E245E132E72B924697AB59412D37DC1/",
 ["Dark Metal Energy"]="1683750229116821380/6C0D1D7081A779E23345F683B3748190CE1DCDB3/",
 ["R Energy"]="1683750229116834552/C91FAAB0CBB8564181A26CFA7D6CC17E0B7616A2/",
 ["Heal Energy"]="1820018084943433296/51E37C2CD3BF320114B1B8277D9337C29B7F1431/",
 ["Scramble Energy"]="1683750229116840554/6B1943F496ADC3D2EAF5EF76331ADF5EF2B13AF7/",
 ["Holon Energy FF"]="1820018084943432699/860D25447A4301AFAAE2BC25E8EB5E566FE1F5F0/",
 ["Holon Energy GL"]="1820018084943432244/979B2B442313CB08CB17BA6565A320C5F58C4F6B/",
 ["Holon Energy WP"]="1820018084943431935/AD7A91996FA428D1D48C939D5821918A04163C07/",
 ["React Energy"]="1820018084943430289/6B8FD7D5F1F384F135494367377C571AF4A58353/",
 ["δ Rainbow Energy"]="1683750229116880377/488BD9E3EDC7BFE68A2D7CD5D2B32232523CF823/",
 ["Delta Rainbow Energy"]="1683750229116880377/488BD9E3EDC7BFE68A2D7CD5D2B32232523CF823/",
 ["Call Energy"]="1820018084943430547/50BF2638DB063353BB47EE4D8FCB06A3F11E279D/",
 ["Health Energy"]="1820018084943428811/6E7A440AD6888312FC7E55808E7D219BEDF07CE8/",
 ["Recover Energy"]="1820018084943429422/489E47B5DB605B3395FD4633215BECC94685C08C/",
 ["SP Energy"]="1820018084943428317/7FEDABCC7BFC5EFCA9BF81A3D7D2C77AB617F3A5/",
 ["Upper Energy"]="1683750229116903612/6BECDDB3683B440A3E3D77AFAC8C78604F54625A/",
 ["Rescue Energy"]="1820018084943427868/EDCFC1DDE6FE298690A9FE53EA59C2A63C16E090/",
 ["Prism Energy"]="1820018084943427440/E6543E66E425F950888E9D64A02FC3B4461218A0/",
 ["Blend Energy GFPD"]="1683750229116933253/F286FB09FC36EED642E1D91BAD311700FACBB475/",
 ["Blend Energy WLFM"]="1683750229116941512/A6ED59B52A325F95D363F365C122A906550A1824/",
 ["Blend Energy GrassFirePsychicDarkness"]="1683750229116933253/F286FB09FC36EED642E1D91BAD311700FACBB475/",
 ["Blend Energy WaterLightningFightingMetal"]="1683750229116941512/A6ED59B52A325F95D363F365C122A906550A1824/",
 ["Plasma Energy"]="1820018084943427034/711D73D60B2030DB48003377AC58974560CB2D45/",
 ["Herbal Energy"]="1820018084943426637/B5A317AF480B7F2FA123FD24B9C097BB1D51D315/",
 ["Strong Energy"]="1683750229116947485/336C858D594B0498AEF16B0D2FDE65BCF5870241/",
 ["Mystery Energy"]="1683750229116955059/4A22AD19E47F5B93FEE000762833B6205A95E797/",
 ["Shield Energy"]="1683750229116960949/137D74CFDB91C67811F91398003EA09D81CD0519/",
 ["Wonder Energy"]="1683750229116966580/4F4BD0774A7BD26F574E1DC6280227B4F9E99408/",
 ["Double Aqua Energy"]="1683750229116978776/7EF34BBCFA83F3DA74655E069835EF52DF7DF2DB/",
 ["Double Magma Energy"]="1683750229116985866/28FA5DC1CB995E830896C674F4E9BC9BBC483A5D/",
 ["Double Dragon Energy"]="1820018084943426225/9E4F250F04362862FF286EC4C2B6C2EEEA7EF4D7/",
 ["Dangerous Energy"]="1683750229116998557/6896CDB824F8C6F74ED1F227D8E704A96E95C162/",
 ["Flash Energy"]="1683750229116993163/55B69635CB85FCB80B3DCEE570A2DD426A80A2DA/",
 ["Burning Energy"]="1683750229117003446/7F3DBF50972D48976412DC79815AC559375D0E00/",
 ["Splash Energy"]="1683750229117008704/7AB4F32F72FE9EECF5E5BD37230CD23AF00AE2BB/",
 ["Counter Energy"]="1683750229117014248/CB6AE0D2D4C72F4839A6E08B20FA32F05193D563/",
 ["Super Boost Energy Prism Star"]="1683750229117024365/9CB004DB973EAA9A1AC6B35A710BA037293A8D42/",
 ["Super Boost Energy ◇"]="1683750229117024365/9CB004DB973EAA9A1AC6B35A710BA037293A8D42/",
 ["Unit Energy GFW"]="1683750229117033320/B1A186CB682D35601BD33D21AFFC97EE7BA19BFB/",
 ["Unit Energy LPM"]="1683750229117039136/7D50B86421DC86FE8203212C1ACB2F0777141650/",
 ["Unit Energy FDF"]="1683750229117047081/7C5938080148055DFFAF3B3A2D0A64355FB14AD4/",
 ["Unit Energy GrassFireWater"]="1683750229117033320/B1A186CB682D35601BD33D21AFFC97EE7BA19BFB/",
 ["Unit Energy LightningPsychicMetal"]="1683750229117039136/7D50B86421DC86FE8203212C1ACB2F0777141650/",
 ["Unit Energy FightingDarknessFairy"]="1683750229117047081/7C5938080148055DFFAF3B3A2D0A64355FB14AD4/",
 ["Beast Energy Prism Star"]="1683750229117055683/184DACC50436B5C4FEBCE74C179EB40B94308178/",
 ["Beast Energy ◇"]="1683750229117055683/184DACC50436B5C4FEBCE74C179EB40B94308178/",
 ["Memory Energy"]="1820018084943425579/A28022274A637B9B4A8F5B82D0C66415FF14F713/",
 ["Triple Acceleration Energy"]="1683750229117080917/0F6F691D058398D58958CAB9DA7552638C831C55/",
 ["Weakness Guard Energy"]="1683750229117086788/B09FBF126F6C02EDB8E69739D47B5F956BA9B3D4/",
 ["Draw Energy"]="1820018084943425000/C937D8AFC0DA2C1338B3AC752E5F6A742201897E/",
 ["Aurora Energy"]="1820018084943424283/2CDF043EF1206C47FEA80230F6EEAAFCBF6D8BF9/",
 ["Capture Energy"]="1820018084943423849/9C1916409FDD5DDC3BAB53E13513397919241ACA/",
 ["Horror P Energy"]="1683750229117093501/79EA1B98ABF6DE41FF2CA609F5A6BBC60A22C7BC/",
 ["Horror Psychic Energy"]="1683750229117093501/79EA1B98ABF6DE41FF2CA609F5A6BBC60A22C7BC/",
 ["Twin Energy"]="1820018084943422194/9F0F600166F9C56AF153A270E0C61DFEA955B0E5/",
 ["Speed L Energy"]="1820018084943422814/D52F3F7BAE9CF9F8943CD3206BC253698B945C20/",
 ["Speed Lightning Energy"]="1820018084943422814/D52F3F7BAE9CF9F8943CD3206BC253698B945C20/",
 ["Heat F Energy"]="1683750229117105385/C7FC75C02B6245AEB4CB1641C413EDAA5FBDF307/",
 ["Heat Fire Energy"]="1683750229117105385/C7FC75C02B6245AEB4CB1641C413EDAA5FBDF307/",
 ["Hiding D Energy"]="1820018084943420613/CF83050A652DE6CB0171081EB7CB780900F211B3/",
 ["Hiding Darkness Energy"]="1820018084943420613/CF83050A652DE6CB0171081EB7CB780900F211B3/",
 ["Powerful C Energy"]="1683750229117117009/32EFE048DBA0159F0FABF31C7BCE4C13D8BE227B/",
 ["Powerful Colorless Energy"]="1683750229117117009/32EFE048DBA0159F0FABF31C7BCE4C13D8BE227B/",
 ["Aromatic G Energy"]="1683750229117122908/C0F424D20D8904AC496A883E6FC7EE0949A57B63/",
 ["Aromatic Grass Energy"]="1683750229117122908/C0F424D20D8904AC496A883E6FC7EE0949A57B63/",
 ["Coating M Energy"]="1683750229117128061/BE5F41672A99E5B00FD19EF4EBC7CF7238D7EC86/",
 ["Coating Metal Energy"]="1683750229117128061/BE5F41672A99E5B00FD19EF4EBC7CF7238D7EC86/",
 ["Stone F Energy"]="1683750229117133449/096C1AF5718891C59F7676395282067889C47DA0/",
 ["Stone Fighting Energy"]="1683750229117133449/096C1AF5718891C59F7676395282067889C47DA0/",
 ["Wash W Energy"]="1683750229117138510/A4DE7F7D93D981A7BF889ADB1125240324C392CE/",
 ["Wash Water Energy"]="1683750229117138510/A4DE7F7D93D981A7BF889ADB1125240324C392CE/",
 ["Rapid Strike Energy"]="1820018084943420240/84CC4FEF17D2FF32BEEBC560A16C9F52BCC8E048/",
 ["Single Strike Energy"]="1820018084943415140/D11323070BA8C5267DEE21B1E36B0400D066442C/",
 ["Impact Energy"]="1820018084943414696/9EBFB2AABBE27CB96B2D1415F7D3B598F11302E7/",
 ["Lucky Energy"]="1820018084943414420/D2421665E5B777019ADD467AE8F108F906257197/",
 ["Spiral Energy"]="1820018084943414148/5426136AE1AAE405E733D46861998830FC43C54C/",
 ["Treasure Energy"]="1820018084943413769/7A8A3CC88AB2B3C814FB21E8D97A0E1D7F1F805D/",
 ["Fusion Strike Energy"]="1820018084943403185/F49147E443E10277B199180F438BD2C3E0A8D999/",
 ["Double Turbo Energy"]="1832406432240975354/ACE733FD6A52CFFA5EECDD5B7ABF4B31C246F757/",
 ["Holon's Voltorb"]="1832406432242107248/CEFCE05957D7FCA247A998948B95F1FADB323780/",
 ["Holon's Electrode"]="1832406432242108052/42B0415CFD9BE2B9B6881E040AE6F739C318BA37/",
 ["Holon's Magnemite"]="1832406432242107541/8C57ECA25216C9395D14394228E49D79DDADEB27/",
 ["Holon's Magneton"]="1832406432242107014/2674BE166018ABCF33712816473BA1F08F0FBF9E/",
 ["Holon's Castform"]="1832406432242107778/A0DBAC1898F157597D8E67C4EF7EB1821D825050/",
 ["Special Metal Energy"]="1832410242806473363/E1184183CB65B7B50356FF3E4255A0C192725C89/",
 ["Special Darkness Energy"]="1832410242806473639/BC473132569AED6B8EDF08729EED547ED5FDB282/",
}
energyUIFiltered={
 ["Electrode"]="1826780185923088169/8F47AC221D9AFD36BEDABB9D9354B01BB0E4F2D6/",
 ["Charjabug"]="1826780185923088463/B2170F2F1A2EE7E8F54E3D01A44DAAEB471196B2/"
}
toolUI={
 ["Defender"]="1829033806579851023/6F8CED874CEF9E58A88FE1C651EF3F7813209187/",
 ["PlusPower"]="1829033806579862739/2B3BEFAFAC27E4C9F62ECCEB74577E5CD33A80EA/",
 ["Recall"]="1829033806579860331/00D866603442C3E47151F8D19E447F54AED104E4/",
 ["Charity"]="1829033806579851433/91D2403BE5E4FCBCE49FD80B88AAA2B84FF013F0/",
 ["Sabrina's ESP"]="1829033806579850239/E3E9ACAA588343F7F3CB03A29A9F6D82E0383ED0/",
 ["Brock's Protection"]="1829033806579854013/998A0B7593A1658507D1B22B5E22F7B756F269C6/",
 ["Koga's Ninja Trick"]="1829033806579883006/1B64BBD551D1CBA376B6060500C50870D64AE4EC/",
 ["Focus Band"]="1829033806579853365/A58C82E7AD619D0921B4EDF88D72AB1CE38589BA/",
 ["Gold Berry"]="1829033806579853241/06A782FE0EE9C2BBFFFF10436F7D92904568D4C7/",
 ["Miracle Berry"]="1829033806579849829/2888005D54D09B0A9CE5C2134A2A7A5AF3D1943C/",
 ["Berry"]="1829033806579852933/368F33908F5D88B9F2589B39E11311A2E013AB08/",
 ["Balloon Berry"]="1829033806579851080/51913792711D42CF492FAC931F4BBF27D56A5D73/",
 ["EXP.ALL"]="1829033806579854374/1CE34BCF7E3D06A75682300AE240941556D0366B/",
 ["Counterattack Claws"]="1829033806579855941/7195620CF7F2B22EBBFA6F3E43858B9E04A6C247/",
 ["Magnifier"]="1829033806579850642/25AB7678A5D5BE1F270D4FA529D23D49386083B0/",
 ["Multi Technical Machine 01"]="1829033806579850087/15F09B4660F3CA4C12058BEE742148216EE74E21/",
 ["Strength Charm"]="1829033806579863265/956AA62ED988AB68FFF9202D9C8A6563A2224823/",
 ["Grass Cube 01"]="1829033806579863651/333ECFE8887472558CE1D223835530A2F8B4643F/",
 ["Fire Cube 01"]="1829033806579861676/6066D3418C07A9E23A5F2A07A9A1F11BB0DAD894/",
 ["Water Cube 01"]="1829033806579852280/AB3E15CB786757C3018DDB81D95D5C030D48381E/",
 ["Lightning Cube 01"]="1829033806579852674/79EA0B5E9AE89E1684DEBBF08D7995CFF0777A3A/",
 ["Psychic Cube 01"]="1829033806579858987/3F0A99DCFF783253A144FDAFE0809AD9D174CABF/",
 ["Fighting Cube 01"]="1829033806579859724/AD934A50176CB925C06BCC9AB0B7C694EF51FF1D/",
 ["Darkness Cube 01"]="1829033806579864043/23EE38AAA65F5666E3029A05419EAF5DF9B74A4B/",
 ["Metal Cube 01"]="1829033806579854192/357C9B9962D964A6187A0C15E43731ABC44CDF02/",
 ["Healing Berry"]="1829033806579849952/C9F0554923211A1EF4263147479871D1CB702650/",
 ["Memory Berry"]="1829033806579854128/17FB3FE2733EB84E60B2B4DD75A95E6274175C40/",
 ["Time Shard"]="1829033806579859781/8C89A4754C402D6635A933BDD7AC8831BF75702A/",
 ["Weakness Guard"]="1829033806579848933/E2767E7E4F7A508F926524674C242B3C5AABEB52/",
 ["Crystal Shard"]="1829033806579849459/FE7E297582AAEA1F3F41AE1BD088B025377A0B73/",
 ["Miracle Sphere α"]="1829033806579858515/242F870B84DCD6205DA2BF79E1AAB478611A7309/",
 ["Miracle Sphere β"]="1829033806579854770/05B33A3BC30322E4E169BA59DEA26AB0BAFE0B96/",
 ["Miracle Sphere γ"]="1829033806579859843/0797024CA9C0B2B25CD305A538B239AC37AE692F/",
 ["Mystery Plate α"]="1829033806579859274/E948C51B8FCE5C0B0CB0C1270A7025985C6B67B2/",
 ["Mystery Plate β"]="1829033806579864156/9C633C0F045D5EFA3BDADEAC8987B869F15438A7/",
 ["Mystery Plate γ"]="1829033806579861906/E7A071A5BFEFE3DAE4E5889D57AC48AE4DC7B8A1/",
 ["Mystery Plate δ"]="1829033806579854965/2D9D2D40B8F596F3A64C444914315191DE5010B4/",
 ["Star Piece"]="1829033806579849363/C1A8E027133487A8FC9B25EF5E7A8569799DA31E/",
 ["Lum Berry"]="1829033806579855670/05BEB1BC2480282B8DB3BC4B2009E58F21BAA900/",
 ["Oran Berry"]="1829033806579856491/9BD837817154762D9B3B0E390CDAFBEF25B21F92/",
 ["Buffer Piece"]="1829033806579862906/FA2929DEFAC430E8563D7C727A2E1CA4857AD697/",
 ["Team Aqua Belt"]="1829033806579856614/BFE215ED610C596699E1E0E03EFCF2C06AA064D8/",
 ["Team Magma Belt"]="1829033806579860923/2A26729482021791C41B9FB003DB4443AF7914F5/",
 ["Team Aqua Technical Machine 01"]="1829033806579861594/9D164ADE9FEE99349DB3ADBDEB5DE762A037B2E4/",
 ["Team Magma Technical Machine 01"]="1829033806579861509/96755D0F9F6B4CCA1B5097A347CF010B237855B8/",
 ["Ancient Technical Machine [Ice]"]="1829033806579859412/D7B70FD43298A882A0D318BEE459F6C0529BF633/",
 ["Ancient Technical Machine [Rock]"]="1829033806579860838/9D6FC20553D600BE7B34E4C4A54C87ADAE95675B/",
 ["Ancient Technical Machine [Steel]"]="1829033806579855537/A9DFBB8BC00405969E0DB9338C1FEB7D159769AA/",
 ["Curse Powder"]="1829033806579858840/5DC93C704D59E0461E3A5966EE287F4CE5C964A9/",
 ["Energy Root"]="1829033806579853120/3DA1F3405BB4BB9060CAEB36F0852DEAE800140A/",
 ["Protective Orb"]="1829033806579853301/9FB29EEFD60D33B128F13C0BBA085C595E5E2ADC/",
 ["Fluffy Berry"]="1829033806579852871/DF3981A6D05D6CA1F08BF1419865BBDF781464E6/",
 ["Sitrus Berry"]="1829033806579852338/A58FAD2D0B4C4CE6F3BA811F5EA3B31C31D07684/",
 ["Solid Rage"]="1829033806579854706/41FD6A3FD1B8E1D59DA521DC78AF3974547CE0F6/",
 ["Cessation Crystal"]="1829033806579856984/848630D1474E8A2B79EF90AACFA75404EFCB8BFF/",
 ["Mysterious Shard"]="1829033806579858775/616B22380968D8FF90A233006C306D2B72A3A5CF/",
 ["Unown E"]="1829034336112388647/2D2DB0A4FF1555B095853E1729E6F36BC9ADC607/",
 ["Unown G"]="1829034336112387748/EC35F083B27D3B15D452226C5F4B06740FF3D928/",
 ["Amulet Coin"]="1829033806579849665/15E8685F8A2EA3D1E7D491B50B897371AA0CED8C/",
 ["Leftovers"]="1829033806579849078/DA28014097783BDB4E703B3C5A4DAC972E962B29/",
 ["Unown Q"]="1829034336112388275/AF5523978C6B3577002345FBF6FF3885B625771C/",
 ["Bubble Coat"]="1829033806579857696/43F174F5268712B39CFF92D28C691ADC0534D8CB/",
 ["Technical Machine TS-1"]="1829033806579851299/E3562CED9A4353D86E342E808576C8B67EECD4A9/",
 ["Technical Machine TS-2"]="1829033806579864976/93163726C37E11002D3C959E20CFA8DEB4A27E1B/",
 ["Energy Link"]="1829033806579851554/A789963082D34DD2766803056567C2169DD25E94/",
 ["Team Galactic's Invention G-101 Energy Gain"]="1829033806579859477/4BF8AE3A997193743308152CD125036306D8858F/",
 ["Team Galactic's Invention G-107 Technical Machine G"]="1829033806579854251/413F3468D9E49A5461F3D39433E0DCE9F3EB9ABF/",
 ["Bench Shield"]="1829033806579859664/D3D36550C6B3EB33802949BE2371C978E8AB1CE3/",
 ["Expert Belt"]="1829033806579858713/A4D42099D25AF0D94E24376F0CE51F677AD2D32B/",
 ["Lucky Egg"]="1829033806579850893/D8196EBE1BFA2F6B977D64CFE787F6CD0A18321C/",
 ["Eviolite"]="1829033806579859200/95166B7A71CFAE6D8F17F6CA014EA5E2F8ECA2DF/",
 ["Rocky Helmet"]="1829033806579855219/A819BC87E8D34D2A83063632DE7D206D97CAA3D9/",
 ["Exp. Share"]="1829033806579855869/4E1353F58ACE22B3EEED0B66FC4782E607EFF4C5/",
 ["Dark Claw"]="1829033806579862461/7C1428D6EBD18A5F4D46CBB46B66C149E4CD90EE/",
 ["Giant Cape"]="1829033806579857600/D8EE291BD386D0771896BF94C3C06F186D129794/",
 ["Rescue Scarf"]="1829033806579856167/4E13631C422195DFDF572443F930618792FD456A/",
 ["Crystal Edge"]="1829033806579858908/5CAA198346DA5EE04F9A7104ACB22F5DCAEB8B08/",
 ["Crystal Wall"]="1829033806579891952/66D40E20D14935AAAE159AEF41ACC4CE94DA913D/",
 ["Victory Piece"]="1829033806579861257/76C61D955F1070915BB372645702E454B405D9E4/",
 ["Float Stone"]="1829033806579852073/B042C2C233B74EE678E1BE1195EB7A13934F14A1/",
 ["Team Plasma Badge"]="1829033806579856002/DDE6CED2DB099CFA180C8F274A72183A0C4B487A/",
 ["Life Dew"]="1829033806579854566/7D653E84A819F0018FCB4392758E2C7CEC3D5683/",
 ["Rock Guard"]="1829033806579852151/973DE8C21CBFE66CD6E16B41F630CEF35E663B7F/",
 ["Reversal Trigger"]="1829033806579853826/BBD16F71F1D3D67FB1F251E21FA1A89FB4E781C4/",
 ["Silver Bangle"]="1829033806579863843/74E209D7C622E07ED620477DC8E6A853C3CFD1A2/",
 ["Silver Mirror"]="1829033806579861013/7CD987D2E42A1C2B5DD23F98B224EAA1867F4A33/",
 ["G Booster"]="1829033806579863406/A744B53FD3AA11EF703F4287031F55DAFDDAB403/",
 ["G Scope"]="1829033806579851615/43D9A27BAE1B5EC05AAF3ADABC492BB842710DC6/",
 ["Hard Charm"]="1829033806579848734/311A6E4D8DA6A652E171DBBD03B0CD14A7D16E8F/",
 ["Muscle Band"]="1829033806579855806/1A3BCAE1E8839FB86F652119EF1FAD72037EB24E/",
 ["Protection Cube"]="1829033806579860262/B3AB26A23EA904358367D3BE204B30DAED2FC1BA/",
 ["Focus Sash"]="1829033806579864224/2493B14B4A04B7AA6E55E63A695F3191FD015E22/",
 ["Sparkling Robe"]="1829033806579855276/6A6013F58B2838A4494B7EEAED104E7F38068FCA/",
 ["Gengar Spirit Link"]="1829033806579858450/A88835B71627AB6589F9EE33BE1827A6E6F2078E/",
 ["Head Ringer Team Flare Hyper Gear"]="1829033806579862661/2BB3D445541A818AB27D46E40362CC1D80D843C0/",
 ["Jamming Net Team Flare Hyper Gear"]="1829033806579850011/92FB9EDC64AC2E94C7C01EE0C73D1F9416AD7360/",
 ["Manectric Spirit Link"]="1829033806579851741/AB9B9B64697A27AA557B6F25A5A4DF182023764C/",
 ["Trick Coin"]="1829033806579858106/DB0D861698AF1D7CDC2BE05B2CD1AEE69C41887B/",
 ["Aggron Spirit Link"]="1829033806579853889/CF3D5815AAA62D68B6C5A1A85282CA63403ABD92/",
 ["Gardevoir Spirit Link"]="1829033806579857061/8276D232BE84597526A6265C68112FBF705B0244/",
 ["Groudon Spirit Link"]="1829033806579861339/BE06A0E03EE4D87E88929E38AEFCFE274BD2C7E9/",
 ["Kyogre Spirit Link"]="1829033806579855742/CB78D80B8C6FC2BF4356B9025BE4D226FF81F19E/",
 ["Weakness Policy"]="1829033806579864786/5755014378CECEBFA85C964F1268A3B9FBDA1963/",
 ["Aqua Diffuser"]="1829033806579853755/D5BEBFCAF028FF46C068CC3788371C7FE6BAA0BF/",
 ["Magma Pointer"]="1829033806579848872/05A2DA058DF067509D07912CF7AA4BB2D882B125/",
 ["Gallade Spirit Link"]="1829033806579853051/013143763602A0F74DDF1E4A549642AD43B6CE48/",
 ["Healing Scarf"]="1829033806579864098/4518AAB068A42D5C5599391B9C8326A30791A597/",
 ["Latios Spirit Link"]="1829033806579853618/1DE60431CA78DD09F0AFA1FE1E295F570C9111D1/",
 ["Rayquaza Spirit Link"]="1829033806579852469/AE8B0488349FAD326B0FB8C136C2A52469171A98/",
 ["Wide Lens"]="1829033806579862820/8CCBD4AFA437D7D518BC919B703FB29C21739AAC/",
 ["Ampharos Spirit Link"]="1829033806579856244/3FB37F39B24EF0F4B64A7D14A47D82F3423B515E/",
 ["Lucky Helmet"]="1829033806579859124/17F4CE73DD8C873D6AA5808455891F44FB8D3D5E/",
 ["Sceptile Spirit Link"]="1829033806579863469/E72D273A7498CD5F3B4E11F132BDFBCE5B0C6F8C/",
 ["Tyranitar Spirit Link"]="1829033806579864447/FE3179228C08A9097705E114016C6A58DE3AF4E7/",
 ["Assault Vest"]="1829033806579858298/3A3184945D5CF9234C4B64D06774B53EDB72731F/",
 ["Glalie Spirit Link"]="1829033806579854905/819442BCE5F6A3BC658EE322ABDBD0BD5D435BB3/",
 ["Heavy Boots"]="1829033806579862196/44E05F937250CA0F875E44051D0159523401B425/",
 ["Houndoom Spirit Link"]="1829033806579853681/E96A74DFDD892D3068486B0C9CB6793482F084D1/",
 ["Mewtwo Spirit Link"]="1829033806579851801/13B7E292BEBD138A928BB990DFEE790FC0BF1C41/",
 ["Aerodactyl Spirit Link"]="1829033806579860500/FD14086F0FB9FB8EB5E467539456805385417754/",
 ["Bursting Balloon"]="1829033806579851874/D991BDEFF6683C4335EECAA8C85F7FBA7B22BE31/",
 ["Fighting Fury Belt"]="1829033806579860420/ECD59C1FB1BEB944DC45B1BD3B2953DBB58D2CA5/",
 ["Gyarados Spirit Link"]="1829033806579863530/33F41550B6F3A95B2893E5C7BC0606727B7143C0/",
 ["Scizor Spirit Link"]="1829033806579864851/12D397464AC3BCF24BE868622FD561202088B11F/",
 ["Floral Crown"]="1829033806579857409/0510504744D9B5C0BD664892514A8291BAD3D82E/",
 ["Alakazam Spirit Link"]="1829033806579864296/97EA53442466226C6A0C3F63182D2AA763B678C8/",
 ["Altaria Spirit Link"]="1829033806579857153/4F5051469CB2DF64F74DD7A1A4B6897C3D8996D6/",
 ["Audino Spirit Link"]="1829033806579849294/7710322326D8B68F3BCE3A9EFFCFF57010FE4B07/",
 ["Bent Spoon"]="1829033806579849532/881623FEE84FFCA77F5B3A89395FC1939285A251/",
 ["Energy Pouch"]="1829033806579863039/E1CE481A309151F1425712EF2281225EC3BFB969/",
 ["Mawile Spirit Link"]="1829033806579863192/2B1E6C0B5B80D3CBC8C9437A02BF180FE5343CDC/",
 ["Power Memory"]="1829033806579855156/F3946F3BB123FD1C9CA1FF1772DB20C4F579A41C/",
 ["Steelix Spirit Link"]="1829033806579857827/A6C5227CBA10D5E74ED3C55C3059CFF0E950368B/",
 ["Beedrill Spirit Link"]="1829033806579863719/7DA187B60DD12DD8C92C065B0DC4BB3D53378D1F/",
 ["Blastoise Spirit Link"]="1829033806579850430/D44AD143E2791DD020387C65420067ED7B5F2D04/",
 ["Charizard Spirit Link"]="1829033806579848662/4968359C2E3606C1658209A6F93CE67DFB8CB06D/",
 ["Pidgeot Spirit Link"]="1829033806579855079/8A9D1DD4E6A48FECB7498C2350D870C474E8CDD5/",
 ["Slowbro Spirit Link"]="1829033806579859987/53D79B6C2A4E78AEDB53D72BA97E64837A4E2D30/",
 ["Venusaur Spirit Link"]="1829033806579860185/B6275874C3A862756F84457D15E27E7D9E730783/",
 ["Garchomp Spirit Link"]="1829033806579850573/C4DBA35B9A90ACFB8E8045E83E3E9DAC0BAD9607/",
 ["Salamence Spirit Link"]="1829033806579864706/93758509CDD2F2077E10EF6BAB3EF16BD680F023/",
 ["Poison Barb"]="1829033806579858209/B3B938086909728F4315B03027ADDF19B65788F3/",
 ["Choice Band"]="1829033806579850303/A75BF6820DB1AA38959A9C16276AD72D88F794DB/",
 ["Sharpedo Spirit Link"]="1829033806579856071/C0BB365BA778F62AFBC353466995EB8B8076C78D/",
 ["Camerupt Spirit Link"]="1829033806579864510/60597177979B72E7F3AD4C3CB406FF0D98605987/",
 ["Lucario Spirit Link"]="1829033806579875466/D42EB6CD13B8DB6A488FC1797007F98E79A15A8A/",
 ["Bodybuilding Dumbbells"]="1829033806579850714/8802A51F4AE8C0EBF17402603DC759CD5A2537AE/",
 ["Wishful Baton"]="1829033806579860683/20E2981861E6150EEE6892FFA83E26A60AB85BC7/",
 ["Dashing Pouch"]="1829033806579851152/66C35C3DB21653DDD88C7044A361543A1B235ED4/",
 ["Fighting Memory"]="1829033806579858587/F3515D09887F8D33BE7B878952017AE341E725FE/",
 ["Psychic Memory"]="1829033806579854312/7C66019152ACCA560A5D100C99B2A53B82B29D57/",
 ["Ancient Crystal"]="1829033806579849600/880C974E1C96F503F78E59C974F085765B7923F6/",
 ["Electric Memory"]="1829033806579853178/F7AAE0BCEEC71D6BD3AF051D19BD016F5BA6D498/",
 ["Escape Board"]="1829033806579857331/AA8B7EB7EE4FE8D74B080AD21EAB58C5F810FE0D/",
 ["Fire Memory"]="1829033806579862282/93058EAB85BEDA3411C3B479F298A0CF577534EA/",
 ["Beast Ring"]="1829033806579892350/21EAED28FD08B5E8B808244232D4ED8B6B5D30D6/",
 ["Metal Frying Pan"]="1829033806579851230/E3B6DF26FE74E0F9ECFE4F6CEAD1594F03557711/",
 ["Hustle Belt"]="1829033806579861089/18103B3C63EA35CB36ED7C8DFA10969FA26B4BEF/",
 ["Dragon Talon"]="1829033806579859609/8C971AE42E3B1C604729FDBD6B4790D52AD82535/",
 ["Choice Helmet"]="1829033806579855021/E916EA979F552FF86F974271A4BF112CA1CBC79A/",
 ["Counter Gain"]="1829033806579853490/531B32F322E82E1475C9C309938ECBDD49FAB016/",
 ["Fairy Charm Grass"]="1829033806579852992/6C0F4CC2048244E18A23E2B06F2C42967E0B661B/",
 ["Fairy Charm Psychic"]="1829033806579855334/E7C230042602B6D304984137D80AC17233F7E4F0/",
 ["Fairy Charm Fighting"]="1829033806579854070/4FEF485C2CF28FD73F75C07167130C1B31321D32/",
 ["Fairy Charm Dragon"]="1829033806579864573/E8BC7F4BC3C75F85C94A22368B0307ADD39E6B3C/",
 ["Spell Tag"]="1829033806579892854/8F417E5B8F15A128A90B577A8E6488788256EF2B/",
 ["Buff Padding"]="1829033806579861995/E5DD1224E5DDF6375A03F3CA645E7D2F41155998/",
 ["Fairy Charm UB"]="1829033806579859058/3B071EBE60C232A375146A3AA388B6C97A491171/",
 ["Grass Memory"]="1829033806579863590/B53FD685800676207D7B7E8C26F1100710C30B6E/",
 ["Metal Goggles"]="1829033806579863115/9A80D52A4E2551E5A2D78F49037BC9C0175FF8C9/",
 ["Water Memory"]="1829033806579860757/EE973078EB533B7C545FB5B52873E1FB23B80CA6/",
 ["Beast Bringer"]="1829033806579858382/A342247D4AD7B076E666F49BAB86112DF705A056/",
 ["Fairy Charm Lightning"]="1829033806579861759/7FB6BFB2B1904385DDCEE277437835D4881AB70A/",
 ["Fairy Charm Ability"]="1829033806579854442/42BA33DC33E69D984C74476B969050713ECBB6FA/",
 ["Metal Core Barrier"]="1829033806579859535/286F4255E26B2CAC116FF2082DC366954FE4CC88/",
 ["Stealthy Hood"]="1829033806579853947/6F4BD0EDD13848D59C86F41FBC57B2592B734F14/",
 ["Ear-Ringing Bell"]="1829033806579851678/E5AB1D5A554658FD18A263BAF7C90989AFDE4C92/",
 ["Flyinium Z: Air Slash"]="1829033806579852404/B3178FE3763D6FBBB195982504BECCFDAFFA3D8B/",
 ["Giant Bomb"]="1829033806579863784/BC67CC618246020CA0A4E64D1E7AE106D9D8CD97/",
 ["Karate Belt"]="1829033806579861829/4E88B2D587D0EB0F879790D1E3CE0744C996D53B/",
 ["Normalium Z: Tackle"]="1829033806579864358/283742EFD2EEE6B91477B1C01B33737464033CCB/",
 ["U-Turn Board"]="1829033806579860117/459ACD143529506F4EAF97F2E53AA0B100E24C70/",
 ["Beastite"]="1829033806579853557/E0D4875705545B4DBCB2CEE0AE869F0A428FC4D9/",
 ["Dragonium Z: Dragon Claw"]="1829033806579855608/F94D8DC1C137441E25C499F0BD76FBE39BA0626D/",
 ["Island Challenge Amulet"]="1829033806579857930/5A608C89867FBF8701E87144263E9772F4BD1DCF/",
 ["Air Balloon"]="1829033806579852610/15EDEB3BFCCC96B206BA2446D87E9F41E5AC0FCC/",
 ["Big Charm"]="1829033806579852215/52A1ACDA10EDF6B9A52D8A0CA7213C4665CEC005/",
 ["Vitality Band"]="1829033806579861430/B25C2BE52D1C2BF3FC1DC481EA332FE26142A0DB/",
 ["Burning Scarf"]="1829033806579852812/433A678514C455718F2208882C13847E4AD08A89/",
 ["Cursed Shovel"]="1829033806579858653/E7A0B1B609C936A8DDB82CA0E64A322EAB6C44ED/",
 ["Big Parasol"]="1829033806579863329/BC38081226B227D3417FBDC42E2A3915C026204A/",
 ["Billowing Smoke"]="1829033806579848798/FB3A3616B458C31469B35F16A880F566BE4AE668/",
 ["Cape of Toughness"]="1829033806579857236/52CCFB285F6C04CEF7555AF5ACEE7FB37F00F2D3/",
 ["Struggle Gloves"]="1829033806579861169/2C7A679988924B9210FC1A8E3DF82A296AE26E0C/",
 ["Hero's Medal"]="1829033806579851495/C70CD120BAF4DFB38E33CEB6045800F5D3327A0F/",
 ["Memory Capsule"]="1829033806579863916/6E1AA5FD08A4D0C5AEE8B265A9DFF1DD62504F1A/",
 ["Telescopic Sight"]="1829033806579851362/30D0D21E7D8EB116EE5E98F7477A23A5D56A3F58/",
 ["Rusted Shield"]="1829033806579862964/1F0C422B9D6094CCD9CDB650DF6E83F2F90B00F5/",
 ["Rusted Sword"]="1829033806579854845/1E327A9732561714E49DF9556FF6313C0716345E/",
 ["Rapid Strike Scroll of Swirls"]="1829033806579856374/31C3AF6705A143659376B5C283CD1BBF7F9382F3/",
 ["Single Strike Scroll of Scorn"]="1829033806579852541/521504D9E03E26E8DAEE8CB3623A937F53FDB7FC/",
 ["Tool Jammer"]="1829033806579857486/4AA8C673559E1A9A62E990071F683FD296F21818/",
 ["Crushing Gloves"]="1829033806579860054/7CB472CDBAC934E8E26C228A093AD71061D5586F/",
 ["Fire-Resistant Gloves"]="1829033806579858010/16E273A4FD2748B1072136B552406FEE1E09B123/",
 ["Galarian Chestplate"]="1829034336109606604/B7ECCE163472EEC24B04FD20F8460D363FE44386/",
 ["Justified Gloves"]="1829033806579854508/8AC75C0281782887ABBF1516F6B9D32257E4791B/",
 ["Rapid Strike Scroll of the Skies"]="1829033806579853425/BD8D4BAE1D90029250E4AB2C048A7C20133F5085/",
 ["Rugged Helmet"]="1829033806579862558/FA8B3ACB6C0CF46A4392B029DF53D0DBF1977BBC/",
 ["Single Strike Scroll of Piercing"]="1829033806579855465/6B5AFC2A7124099DFEE6104D1BC881212C6A7605/",
 ["Weeding Gloves"]="1829033806579850366/C6E6C76A631A3CEB064FB4F6AE075218C4EEC905/",
 ["Digging Gloves"]="1829033806579862093/831F432DC6F12B8AA7F427A97BB64EC8C1A9C88F/",
 ["Elemental Badge"]="1829033806579854640/25F0E09A9BB4F739D352AF86F8B9081ECE387FDB/",
 ["Full Face Guard"]="1829033806579860602/9BF6C5F35A0167C66659F5C8F49EC51DE02F935F/",
 ["Moon Sun badge"]="1829033806579852011/C3B300F50344570CA0C49E62B428998CFA6F7F2F/",
 ["Rapid Strike Scroll of the Flying Dragon"]="1829033806579851943/83B8DBC79CCABCA842233ED579C78E970D403231/",
 ["Ribbon Badge"]="1829033806579864638/977AC1706F645BFFF57600BA729E619A969D86C7/",
 ["Rubber Gloves"]="1829033806579850155/31B56C0EC8BE49B06A209801EF2A19754CF6CDE9/",
 ["Single Strike Scroll of the Fanged Dragon"]="1829033806579850822/670CA45DFC4169D9B85D4096A79C239DB23C0C13/",
 ["Snow Leaf Badge"]="1829033806579850959/590050C4C5469E20AE0B27B5A402E208A07DB62B/",
 ["Spirit Mask"]="1829033806579855404/421339B534A93B4D2E754781312A5535F32F368A/",
 ["Farewell Bell"]="1829033806579864909/1C2D35A11124954A8D2198404EFA5DB41B352FF5/",
 ["Spongy Gloves"]="1829033806579850511/267D3C2BBB591478D668018B729D073A82A54DF1/",
 ["Blunder Policy"]="1829033806579849013/98C325DB435D616CA373FD93AFF0FDE463308AA4/",
 ["Choice Belt"]="1829033806579859343/00439D34B7CED0D4DD9A7E15A5EE26F89D37A531/",
 ["Cleansing Gloves"]="1829033806579852745/005317A4739C128E587EF93022817809D03C244E/",
 ["Hunting Gloves"]="1829033806579849889/9F1DF9F8F287775FFDF3140A0AA477158F247D3A/",
 ["Pot Helmet"]="1829033806579849235/A042E3CBB2A46961E60E8AA0051D0681CC7B2F8C/",
}
toolUIFiltered={
 ["Klefki"]="1829034336112395603/B07DB6CF60F329FDAED655801B8A0700A9C5C529/",
 ["Shedinja"]="1829034336112395899/09A0E7A3172D0FF0D2E8D5C66B4583FFB277D147/"
}
setFilter={
 ["Electrode"]={"Base","Evolutions #40"},
 ["Klefki"]={"Steam Siege #80"},
 ["Shedinja"]={"Lost Thunder #95"},
 ["Charjabug"]={"Unbroken Bonds #58"},
}
specialFilter={
 ["Darkness Energy"]=true,
 ["Metal Energy"]=true
}

function onLoad()
 Wait.condition(redrawUI,function()return self.type=="Bag" end)
end

deleting=false
function onObjectLeaveContainer(cont)
 if cont==self and not deleting then redrawUI()end
end

function tryObjectEnter(obj)
 if obj.type=='Card'and isAttachment(obj.getName(),obj.getDescription())then
  Wait.frames(function()redrawUI()end,1)
  Wait.frames(function()redrawUI()end,5)
  Wait.frames(function()redrawUI()end,60)
  return true
 elseif obj.type=='Deck'then
  local takeObj=nil
  local remain=nil
  cards=obj.getObjects()
  for c=#cards,1,-1 do
   if isAttachment(cards[c].name,cards[c].description)then
    if remain then
     takeObj=remain
    else
     takeObj=obj.takeObject({index=c-1})
     remain=obj.remainder
    end
    self.putObject(takeObj)
   end
  end
  Wait.frames(function()redrawUI()end,1)
  Wait.frames(function()redrawUI()end,5)
  Wait.frames(function()redrawUI()end,60)
 end
 return false
end

function isAttachment(name,desc)
 return energyUI[name]or toolUI[name]or(setFilter[name]and startsWithInTable(desc,setFilter[name]))
end

function countCardsInBag()
 energy={}
 tools={}
 totalEnergy=0
 objs=self.getObjects()
 for k,v in pairs(objs)do
  local name=v.name
  if energyUI[name]or energyUIFiltered[name] then
   if startsWith(v.gm_notes,"8")then
    if specialFilter[name] then
     name="Special "..name
    end
   end
   energy[name]=(energy[name]or 0)+1
   totalEnergy=totalEnergy+1
  else
   tools[name]=(tools[name]or 0)+1
  end
 end
end

function redrawUI()
 countCardsInBag()
--are we condensing the energy (ie showing 2x text)
 local condensed=totalEnergy>4
 local assets={{name="All",url="http://cloud-3.steamusercontent.com/ugc/1832410674995875923/20F7BE0497D73F3D0B0ED3188F59165150DDF742/"}}
 local e={}
 local t={}

 for k,v in pairs(energy)do
  assets[#assets+1]={name=k,url="http://cloud-3.steamusercontent.com/ugc/"..(energyUI[k] or energyUIFiltered[k])}
  if v>1 and condensed then
   e[#e+1]=getElementImage(k,600)
   e[#e+1]=getElementText(v)
  else
   for i=1,v do
    e[#e+1]=getElementImage(k,600)
   end
  end
 end
 local wide=false
 for k,v in pairs(tools)do
  assets[#assets+1]={name=k,url="http://cloud-3.steamusercontent.com/ugc/"..(toolUI[k] or toolUIFiltered[k])}
  if v>1 then
   t[#t+1]=getToolFrame({getElementImage(k,540),getElementText(v)})
   wide=true
  else
   t[#t+1]=getElementImage(k,540)
  end
 end

 self.UI.setCustomAssets(assets)
 Wait.time(function()setXml(e,t,wide)end,0.15)
end

function setXml(e,t,wide)
 XMLTable={{tag="HorizontalLayout",
  attributes={
   height=675,
   width=2800,
   rotation="0 0 180",
   position="1400 0 16",
   color="rgba(0,0,0,0.7)",
   childForceExpandWidth=false,
   childForceExpandHeight=false,
   childAlignment="MiddleLeft",
   padding="35 330 35"
  },
  children=e
 }}
 if #e!=0 or #t!=0 then
  XMLTable[2]={
   tag="Image",
   attributes={
    image="All",
    height=250,
    width=500,
    position="-5 450 0",
    rotation="0 0 180",
    allowDragging=true,
    onClick="clickAll()",
    onEndDrag="dragAll()",
   }}
  XMLTable[3]={
   tag="Panel",
   attributes={
    height=250,
    width=250,
    position="-125 220 0",
    color="#0d1a92"
   }}
 end
 if #t>0 then
  local tHieght=540*#t+350
  local tWidth=0
  if wide then tWidth=230 end
  XMLTable[#XMLTable+1]={tag="VerticalLayout",
   attributes={
    height=tHieght,
    width=675+tWidth,
    rotation="0 0 180",
    position=tostring(tWidth*-1/2).." "..tostring((tHieght/2)*-1).." 16",
    childForceExpandWidth=false,
    childForceExpandHeight=false,
    color="rgba(0,0,0,0.7)",
    padding="35 35 35 315",
    childAlignment="LowerLeft",
   },
  children=t
  }
  end
 self.UI.setXmlTable(XMLTable)
end

function getElementText(num)
 return{tag="Text",
  attributes={
   resizeTextForBestFit=true,
   color="white",
   fontSize=250,
   resizeTextMaxSize=250,
   text="*"..num,
  },
 }
end

function getElementImage(name,height)
 return{tag="Image",
  attributes={
   preferredHeight=height,
   preferredWidth=600,
   image=name,
   preserveAspect=true,
   allowDragging=true,
   restrictDraggingToParentBounds=false,
   onClick="clickCard("..name..")",
   onEndDrag="dragCard("..name..")",
  }}
end

function getToolFrame(c)
 return{tag="HorizontalLayout",
  attributes={
   color="rgba(0,0,0,0)",
   childAlignment="LowerCenter",
  },
  children=c
 }
end

function clickCard(player,n)
 objs=self.getObjects()
 for k,v in pairs(objs)do
  if v~=nil and checkCardName(v,n) then
   self.takeObject({guid=v.guid,position=self.positionToWorld({13.15,0,16}),rotation=self.getRotation()})
   break
  end
 end
end

function dragCard(player,n)
 objs=self.getObjects()
 for k,v in pairs(objs)do
  if v~=nil and checkCardName(v,n) then
   playpos=player.getPointerPosition()
   playpos.y=playpos.y+1
   self.takeObject({guid=v.guid,position=playpos,rotation={0,player.getPointerRotation(),0},smooth=false})
   break
  end
 end
end

function clickAll(player)
 objs=self.getObjects()
 for k,v in pairs(objs)do
  if v~=nil then
   self.takeObject({guid=v.guid,position=self.positionToWorld({13.15,0,16}),rotation=self.getRotation()})
  end
 end
end

function dragAll(player)
 objs=self.getObjects()
 for k,v in pairs(objs)do
  if v~=nil then
   playpos=player.getPointerPosition()
   playpos.y=playpos.y+1
   self.takeObject({guid=v.guid,position=playpos,rotation={0,player.getPointerRotation(),0},smooth=false})
  end
 end
end

function checkCardName(card,name)
 if specialFilter[card.name]then
  if startsWith(name,"Special ")then
   return(card.name==string.sub(name,9,#name) and string.sub(card.gm_notes,1,1)=="8")
  else
   return (card.name==string.sub(name,1,#name) and string.sub(card.gm_notes,1,1)=="7")
  end
 else
  return card.name==name
 end
end

function startsWithInTable(input,prefix)
 for _,str in pairs(prefix)do
  if startsWith(input,str) then
   return true
  end
 end
 return false
end

function startsWith(input,prefix)
 return string.sub(input,1,#prefix)==prefix
end

function onDestroy()
 deleting=true
 local numCards=self.getQuantity()
 for c=numCards,1,-1 do
  self.takeObject({index=0,position=self.positionToWorld{0,0,0}})
 end
end
]]
